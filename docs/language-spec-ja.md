# Grimoire言語仕様 v3.0 - 魔法陣パラダイム

## 目次
1. [はじめに](#introduction)
2. [魔法陣の原理](#magic-circle-principles)
3. [基本図形とその意味](#basic-shapes)
4. [神秘的演算子](#mystical-operators)
5. [エネルギーフローと接続](#energy-flow)
6. [プログラム構造](#program-structure)
7. [データ表現](#data-representation)
8. [制御フロー](#control-flow)
9. [関数とスコープ](#functions-scope)
10. [エラー処理](#error-handling)
11. [高度な機能](#advanced-features)

## はじめに {#introduction}

Grimoireは、古代の魔法陣の知恵をプログラミングに応用した革新的なビジュアル言語です。すべてのプログラムは、エネルギーが流れる神聖な魔法陣として表現されます。

### 基本原則
- **魔法陣の法則**: すべての演算は外側の円に囲まれた魔法陣内で行われる
- **エネルギーフロー**: データは魔法陣内を流れるエネルギーとして表現される
- **神秘的演算**: 標準的な算術記号ではなく、魔術的な意味を持つ記号を使用
- **空間的調和**: 図形の配置と対称性がプログラムの力を決定する

## 魔法陣の原理 {#magic-circle-principles}

### 外円の重要性
すべての演算と処理は、保護と封印の役割を果たす外円に囲まれていなければなりません。外円は以下の機能を持ちます：

1. **エネルギーの封印**: 内部のエネルギーが散逸するのを防ぐ
2. **外部からの保護**: 不要な干渉からプログラムを守る
3. **スコープの定義**: 変数と処理の有効範囲を明確にする
4. **力の増幅**: 内部の演算の効果を強化する

### エネルギーの種類
- **陽のエネルギー（⚡）**: 加算的、創造的な操作
- **陰のエネルギー（☾）**: 減算的、変換的な操作
- **中性エネルギー（◉）**: バランスと調和の操作

## 基本図形とその意味 {#basic-shapes}

### 構造要素

| 図形 | シンボル | 神秘的意味 |
|------|----------|------------|
| 外円 | ⭕ | 魔法陣の境界・保護結界 |
| 内円 | ○ | 内部スコープ・小結界 |
| 二重円 | ◎ | 大魔法陣・メインエントリ |
| 五芒星 | ⭐ | 五大元素の調和・関数定義 |
| 六芒星 | ✡ | 陰陽の統合・並列処理 |
| 八芒星 | ✦ | 完全なる調和・クラス定義 |
| 三角 | △ | 三位一体・条件分岐 |
| 四角 | □ | 四大元素・データ保存 |

### 図形の修飾子

- **光輪付き**: 神聖な/不変の
- **影付き**: 隠された/プライベート
- **発光**: アクティブ/実行中
- **点滅**: 非同期/待機中
- **回転**: ループ/反復中

## 神秘的演算子 {#mystical-operators}

### 基本演算の魔術記号

| 記号 | 名称 | 神秘的意味 | 使用例 |
|------|------|------------|---------|
| ⟐ | 融合の印 | エネルギーの統合（加算） | `⭕[□ ⟐ □]` |
| ⟑ | 分離の印 | エネルギーの分離（減算） | `⭕[□ ⟑ □]` |
| ✦ | 増幅の星 | 力の増幅（乗算） | `⭕[□ ✦ □]` |
| ⟠ | 分割の環 | エネルギーの分配（除算） | `⭕[□ ⟠ □]` |
| ⟷ | 転移の矢 | エネルギーの移動（代入） | `⭕[□ ⟷ □]` |
| ⊗ | 封印の十字 | エネルギーの固定（定数） | `⭕[⊗ □]` |
| ⟳ | 循環の渦 | エネルギーの循環（ループ） | `⭕[⟳ □]` |

### 比較の魔術記号

| 記号 | 名称 | 意味 |
|------|------|------|
| ⟨⟩ | 天秤の印 | 等価判定 |
| ⟨≠⟩ | 不均衡の印 | 不等価 |
| ⟨<⟩ | 下降の印 | より小さい |
| ⟨>⟩ | 上昇の印 | より大きい |
| ⟨≤⟩ | 地の印 | 以下 |
| ⟨≥⟩ | 天の印 | 以上 |

### 論理の魔術記号

| 記号 | 名称 | 意味 |
|------|------|------|
| ⊕ | 光の結合 | AND |
| ⊖ | 光の選択 | OR |
| ⊗ | 光の反転 | NOT |
| ⊙ | 光の排他 | XOR |

## エネルギーフローと接続 {#energy-flow}

### エネルギーラインの種類

| 線種 | シンボル | 意味 |
|------|----------|------|
| ═══ | 主脈 | 主要なエネルギーフロー |
| ─── | 支脈 | 通常のフロー |
| ┈┈┈ | 条件脈 | 条件付きフロー |
| ～～ | 霊脈 | 例外処理フロー |
| ⟷⟷ | 双方向脈 | 相互作用フロー |
| ⟲⟲ | 循環脈 | ループバック |

### エネルギーノード

| 記号 | 名称 | 機能 |
|------|------|------|
| ⬢ | 六角結晶 | エネルギーの分岐点 |
| ◈ | 四角結晶 | エネルギーの集約点 |
| ⬟ | 五角結晶 | エネルギーの変換点 |
| ✧ | 星型結晶 | エネルギーの増幅点 |

## プログラム構造 {#program-structure}

### 大魔法陣（メインプログラム）
```
    ◎═══╗
    ║   ║
    ║ ⭐ ║  ← メイン関数の五芒星
    ║ │ ║
    ║ □ ║  ← データ領域
    ╚═══╝
```

### 魔法陣の階層
1. **大魔法陣（◎）**: プログラムのエントリーポイント
2. **中魔法陣（⭕）**: 関数やモジュール
3. **小魔法陣（○）**: ローカルスコープ

### 実行の流れ
```
⭕════╗
║ ☀  ║  ← 開始の印
║ ↓  ║
║ □  ║  ← データ初期化
║ ↓  ║
║ ⟐  ║  ← 演算実行
║ ↓  ║
║ ☆  ║  ← 結果出力
╚════╝
```

## データ表現 {#data-representation}

### 数値の神秘的表現

| パターン | 値 | 意味 |
|----------|-----|------|
| ● | 1 | 単一の力 |
| ●● | 2 | 二元性 |
| ▲ | 3 | 三位一体 |
| ◆ | 4 | 四大元素 |
| ⭐ | 5 | 五芒星 |
| ✡ | 6 | 六芒星 |
| ❋ | 7 | 七つの天体 |
| ✦ | 8 | 八卦 |
| ◉ | 9 | 九つの世界 |
| ⊕ | 10 | 完成の数 |

### 真理値の表現
- ☀ (太陽) = 真
- ☾ (月) = 偽

### 配列の魔法陣
```
⭕═══╗
║ ※ ║  ← 配列の印
║├─●║
║├─●●║
║└─▲║
╚═══╝
```

### 辞書の魔法陣
```
⭕═══════╗
║  ⊞    ║  ← 辞書の印
║ ●→☀  ║
║ ●●→☾ ║
║ ▲→◆  ║
╚═══════╝
```

## 制御フロー {#control-flow}

### 条件分岐の魔法陣
```
    ⭕═══╗
    ║ △ ║
    ║╱ ╲║
   ☀║   ║☾
   ↓║   ║↓
  ⭕║   ║⭕
    ╚═══╝
```

### ループの魔法陣
```
⭕═══╗
║⟳  ║ ← 循環の渦
║│  ║
║□  ║
║│  ║
║⟲  ║ ← 戻りの印
╚═══╝
```

### 並列処理の魔法陣
```
    ⭕═════╗
    ║  ✡  ║  ← 六芒星（並列の印）
    ║ ╱│╲ ║
    ║○ ○ ○║
    ║ ╲│╱ ║
    ║  ▼  ║
    ╚═════╝
```

## 関数とスコープ {#functions-scope}

### 関数定義の魔法陣
```
⭕═══════╗
║  ⭐   ║  ← 五芒星（関数の印）
║ ↓ ↓  ║  ← 引数の流入
║  □   ║  ← 処理本体
║  ↓   ║  ← 戻り値の流出
╚═══════╝
```

### ラムダ関数の小魔法陣
```
○═══╗
║ λ ║
║ ↓ ║
║ □ ║
╚═══╝
```

### スコープの法則
1. 内側の魔法陣は外側の魔法陣のエネルギーを参照可能
2. 魔法陣の重なりは力の共有を示す
3. 点線の魔法陣は一時的な結界を示す

## エラー処理 {#error-handling}

### 防護魔法陣
```
⭕═══════╗
║   ○   ║  ← try領域
║   ↓   ║
║  ⚡   ║  ← エラートラップ
║  ╱╲   ║
║ ○  ○  ║  ← catch領域
╚═══════╝
```

### エラーの種類
- ⚡ : 雷撃（一般エラー）
- 🔥 : 炎上（致命的エラー）
- ❄️ : 凍結（タイムアウト）
- 💀 : 呪い（メモリエラー）

## 高度な機能 {#advanced-features}

### クラス定義の大魔法陣
```
⭕═══════════╗
║    ✦     ║  ← 八芒星（クラスの印）
║  ┌───┐   ║
║  │□□□│   ║  ← プロパティ
║  ├───┤   ║
║  │⭐⭐│   ║  ← メソッド
║  └───┘   ║
╚═══════════╝
```

### メタ魔法（メタプログラミング）
```
⭕═══════╗
║ ╔═╗  ║
║ ║○║  ║  ← 動的魔法陣生成
║ ╚═╝  ║
╚═══════╝
```

### 召喚魔法（インポート）
```
⭕═══════╗
║  ⟨⟩  ║  ← ポータルの印
║  ║   ║
║  ◈   ║  ← 外部モジュール
╚═══════╝
```

## 魔術的な操作の意味

### 演算の神秘的解釈

1. **融合（⟐）**: 二つのエネルギーを一つに統合し、より強力な力を生み出す
2. **分離（⟑）**: エネルギーから不要な要素を取り除き、純粋な形にする
3. **増幅（✦）**: エネルギーを指定回数分増幅し、力を倍加させる
4. **分割（⟠）**: エネルギーを均等に分配し、バランスを保つ
5. **転移（⟷）**: エネルギーを別の器に移し、新たな形を与える
6. **封印（⊗）**: エネルギーを固定し、不変の状態を保つ
7. **循環（⟳）**: エネルギーを循環させ、永続的な効果を生む

### エネルギーの法則
- すべての演算は外円内で行われなければならない
- エネルギーは保存される（入力と出力のバランス）
- 魔法陣の対称性が高いほど、効率的な実行となる

## ファイル形式

Grimoireファイルは`.grim`拡張子を使用し、以下の形式が可能：
1. **PNG/JPG**: 手描きまたはデジタル描画の魔法陣
2. **SVG**: 正確な幾何学的魔法陣
3. **GRIM**: コンパイルされた魔法陣バイナリ

## 実行の儀式

```bash
# 魔法陣のコンパイル
grimoire compile magic_circle.png -o spell.exe

# 魔法陣の実行
grimoire cast magic_circle.png

# 魔法陣のデバッグ
grimoire divine magic_circle.png
```

---

*この仕様書は、古代の知恵と現代の技術を融合させた生きた文書であり、魔法陣の力と共に進化し続けます。*