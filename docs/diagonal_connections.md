# 斜め接続線の検出

Grimoireは45°と135°の斜め接続線を検出する機能をサポートしています。

## 概要

斜め接続線の検出は、より複雑で表現力豊かな魔法陣の作成を可能にします。現在のシステムは以下の角度の斜め線を検出できます：

- 45° (π/4 ラジアン) - 左上から右下への接続
- 135° (3π/4 ラジアン) - 右上から左下への接続
- -45° (-π/4 ラジアン) - 左下から右上への接続
- -135° (-3π/4 ラジアン) - 右下から左上への接続

## 検出方法

システムは3つの方法を組み合わせて斜め線を検出します：

### 1. Hough変換
特定の角度（45°、135°）に最適化されたHough変換を使用して、エッジピクセルから直線を検出します。

### 2. 線追跡アルゴリズム
エッジピクセルから開始して、4つの斜め方向に線を追跡します。わずかな偏差（±1ピクセル）を許容することで、完全でない斜め線も検出できます。

### 3. シンボル間の直接検出
シンボル間の角度を計算し、22.5°の許容範囲内で斜め接続を判定します。

## 技術仕様

- 最小線長：15ピクセル（斜め線）、20ピクセル（水平・垂直線）
- 角度許容範囲：目標角度から±22.5°
- エッジ検出：対角線用の特別なカーネルを含むCanny風エッジ検出
- 接続検証：暗いピクセルパスの存在（30%以上）

## 使用例

```go
// 斜め接続線を含む魔法陣の例
// □ --- ○
//  \   /
//   \ /
//    ◇
//   / \
//  /   \
// △ --- ⬟
```

## パフォーマンス

斜め線検出は、水平・垂直線検出と同程度のパフォーマンスで動作します。大規模な魔法陣（500シンボル）でも、検出時間への影響は最小限です。

## 今後の拡張

- 任意角度の線検出
- 曲線（ベジェ曲線など）の検出
- 矢印付き線の方向検出
- 線の装飾（二重線、波線など）の認識